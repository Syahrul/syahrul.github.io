"use strict";(self.webpackChunksyahrul=self.webpackChunksyahrul||[]).push([[355],{5355:(q,y,m)=>{m.r(y),m.d(y,{TetrisModule:()=>I});var a,C=m(6895),T=m(3994),t=m(4650);const l=30,g=["none","cyan","lightblue","yellow","green","pink","red"],O=[[],[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[2,0,0],[2,2,2],[0,0,0]],[[0,0,3],[3,3,3],[0,0,0]],[[4,4],[4,4]],[[0,5,5],[5,5,0],[0,0,0]],[[0,6,0],[6,6,6],[0,0,0]],[[7,7,0],[0,7,7],[0,0,0]]];let p=(()=>{var s;class r{}return(s=r).ESC="Escape",s.SPACE=" ",s.LEFT="ArrowLeft",s.UP="ArrowUp",s.RIGHT="ArrowRight",s.DOWN="ArrowDown",r})(),f=(()=>{var s;class r{}return(s=r).SINGLE=100,s.DOUBLE=300,s.TRIPLE=500,s.TETRIS=800,s.SOFT_DROP=1,s.HARD_DROP=2,r})();class v{}(a=v)[0]=200,a[1]=190,a[2]=180,a[3]=170,a[4]=160,a[5]=150,a[6]=140,a[7]=130,a[8]=120,a[9]=100,a[10]=80,a[11]=80,a[12]=80,a[13]=70,a[14]=70,a[15]=70,a[16]=50,a[17]=50,a[18]=50,a[19]=30,a[20]=30;class x{constructor(r){this.ctx=r,this.spawn()}spawn(){const r=this.randomizeTetrominoType(g.length-1);this.shape=O[r],this.color=g[r],this.x=4===r?4:3,this.y=0}reset(){this.spawn()}draw(){const r=1/l;this.shape.forEach((c,e)=>{c.forEach((i,n)=>{i>0&&(this.ctx.fillStyle="black",this.ctx.fillRect(this.x+n-r,this.y+e-r,1+2*r,1+2*r),this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x+n,this.y+e,1,1))})})}drawNext(r){r.clearRect(0,0,r.canvas.width,r.canvas.height);const c=1/l;this.shape.forEach((e,i)=>{e.forEach((n,o)=>{n>0&&(r.fillStyle="black",r.fillRect(o+.05-c,i+.05-c,1+2*c,1+2*c),r.fillStyle=this.color,r.fillRect(o+.05,i+.05,1,1))})})}move(r){this.x=r.x,this.y=r.y,this.shape=r.shape}randomizeTetrominoType(r){return Math.floor(Math.random()*r)+1}}let E=(()=>{var s;class r{valid(e,i){return e.shape.every((n,o)=>n.every((h,M)=>{let w=e.x+M,b=e.y+o;return this.isEmpty(h)||this.insideWalls(w)&&this.aboveFloor(b)&&this.notOccupied(i,w,b)}))}isEmpty(e){return 0===e}insideWalls(e){return e>=0&&e<10}aboveFloor(e){return e<=20}notOccupied(e,i,n){return e[n]&&0===e[n][i]}rotate(e){let i=JSON.parse(JSON.stringify(e));for(let n=0;n<i.shape.length;++n)for(let o=0;o<n;++o)[i.shape[o][n],i.shape[n][o]]=[i.shape[n][o],i.shape[o][n]];return i.shape.forEach(n=>n.reverse()),i}getLinesClearedPoints(e,i){return(i+1)*(1===e?f.SINGLE:2===e?f.DOUBLE:3===e?f.TRIPLE:4===e?f.TETRIS:0)}}return(s=r).\u0275fac=function(e){return new(e||s)},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),r})();const P=["board"],A=["gridCanvas"],k=["next"];function S(s,r){1&s&&(t.TgZ(0,"p"),t._uU(1,"Next Block"),t.qZA())}let R=(()=>{var s;class r{keyEvent(e){if(!this.keyPressCooldown)if(this.keyPressCooldown=!0,setTimeout(()=>this.keyPressCooldown=!1,50),"Escape"===e.key)this.gameOver();else if(this.moves[e.key]){e.preventDefault();let i=this.moves[e.key](this.piece);if(" "===e.key)for(;this.service.valid(i,this.board);)this.points+=f.HARD_DROP,this.piece.move(i),i=this.moves[p.DOWN](this.piece);else this.service.valid(i,this.board)&&(this.piece.move(i),"ArrowDown"===e.key&&(this.points+=f.SOFT_DROP))}}constructor(e){this.service=e,this.moves={[p.LEFT]:i=>({...i,x:i.x-1}),[p.RIGHT]:i=>({...i,x:i.x+1}),[p.DOWN]:i=>({...i,y:i.y+1}),[p.SPACE]:i=>({...i,y:i.y+1}),[p.UP]:i=>this.service.rotate(i)},this.keyPressCooldown=!1,this.dirtyCells=[]}ngOnInit(){this.initBoard(),this.initNext(),this.resetGame()}ngOnDestroy(){this.resetGame()}initBoard(){this.gridCtx=this.gridCanvas.nativeElement.getContext("2d"),this.gridCtx.canvas.width=300,this.gridCtx.canvas.height=600,this.gridCtx.scale(l,l),this.drawBoardBackground(),this.ctx=this.canvas.nativeElement.getContext("2d"),this.ctx.canvas.width=300,this.ctx.canvas.height=600,this.ctx.scale(l,l)}initNext(){this.ctxNext=this.canvasNext.nativeElement.getContext("2d"),this.ctxNext.canvas.width=150,this.ctxNext.canvas.height=120,this.ctxNext.scale(l,l)}play(){this.resetGame(),this.piece?(this.piece.reset(),this.next.reset()):(this.piece=new x(this.ctx),this.next=new x(this.ctx)),this.next.drawNext(this.ctxNext),this.time.start=performance.now(),this.requestId&&(cancelAnimationFrame(this.requestId),this.requestId=0),this.animate()}pause(){!this.requestId||this.isGameOver||(this.isPause=!this.isPause,!this.isPause&&this.requestId?this.animate():(cancelAnimationFrame(this.requestId),this.ctx.fillStyle="black",this.ctx.fillRect(1,2,8,2.5),this.ctx.font="2px miso-bold",this.ctx.fillStyle="red",this.ctx.fillText("PAUSED",2.1,3.9)))}drawBoardBackground(){this.gridCtx.setTransform(1,0,0,1,0,0),this.gridCtx.beginPath();for(let h=0;h<=300;h+=30)this.gridCtx.moveTo(h+.5,0),this.gridCtx.lineTo(h+.5,600);for(let h=0;h<=600;h+=30)this.gridCtx.moveTo(0,h+.5),this.gridCtx.lineTo(300,h+.5);this.gridCtx.strokeStyle="#cacaca",this.gridCtx.lineWidth=.5,this.gridCtx.stroke()}resetGame(){this.points=0,this.lines=0,this.level=0,this.board=this.getEmptyBoard(),this.time={start:0,elapsed:0,level:v[this.level]},this.isPause=!1,this.isGameOver=!1,cancelAnimationFrame(this.requestId),this.requestId=0}animate(e=0){this.time.elapsed=e-this.time.start,this.time.elapsed>this.time.level&&(this.time.start=e,!this.drop())?this.gameOver():(this.draw(),this.isPause||(this.requestId=requestAnimationFrame(this.animate.bind(this))))}draw(){this.ctx.clearRect(0,0,10,20),this.piece.draw(),this.drawBoard()}drop(){let e=this.moves[p.DOWN](this.piece);if(this.service.valid(e,this.board))this.piece.move(e);else{if(this.freeze(),this.clearLines(),0===this.piece.y)return!1;this.piece=this.next,this.next=new x(this.ctx),this.next.drawNext(this.ctxNext)}return!0}clearLines(){let e=0;this.board.forEach((i,n)=>{i.every(o=>0!==o)&&(e++,this.board.splice(n,1),this.board.unshift(Array(10).fill(0)))}),e>0&&(this.points+=this.service.getLinesClearedPoints(e,this.level),this.lines+=e,this.lines>=10&&(this.level++,this.lines-=10,this.time.level=v[this.level]))}freeze(){this.piece.shape.forEach((e,i)=>{e.forEach((n,o)=>{n>0&&(this.board[i+this.piece.y][o+this.piece.x]=n)})})}drawBoard(){const e=1/l;for(this.board.forEach((i,n)=>{i.forEach((o,h)=>{o>0&&(this.ctx.fillStyle="black",this.ctx.fillRect(h-e,n-e,1+2*e,1+2*e),this.ctx.fillStyle=g[o],this.ctx.fillRect(h,n,1,1))})});this.dirtyCells.length>0;){const{x:i,y:n}=this.dirtyCells.pop();this.board[n]&&this.board[n][i]>0&&(this.ctx.fillStyle="black",this.ctx.fillRect(i-e,n-e,1+2*e,1+2*e),this.ctx.fillStyle=g[this.board[n][i]],this.ctx.fillRect(i,n,1,1))}this.dirtyCells.length>50&&(this.dirtyCells=[])}gameOver(){cancelAnimationFrame(this.requestId),this.isGameOver=!0,this.ctx.fillStyle="black",this.ctx.fillRect(0,2,10,2.5),this.ctx.font="2px miso-bold",this.ctx.fillStyle="red",this.ctx.fillText("GAME OVER",.6,3.9)}getEmptyBoard(){return Array.from({length:20},()=>Array(10).fill(0))}}return(s=r).\u0275fac=function(e){return new(e||s)(t.Y36(E))},s.\u0275cmp=t.Xpm({type:s,selectors:[["tetris-board"]],viewQuery:function(e,i){if(1&e&&(t.Gf(P,7),t.Gf(A,7),t.Gf(k,7)),2&e){let n;t.iGM(n=t.CRH())&&(i.canvas=n.first),t.iGM(n=t.CRH())&&(i.gridCanvas=n.first),t.iGM(n=t.CRH())&&(i.canvasNext=n.first)}},hostBindings:function(e,i){1&e&&t.NdJ("keydown",function(o){return i.keyEvent(o)},!1,t.Jf7)},decls:25,vars:3,consts:[[1,"container"],[1,"d-inline-block","align-top"],[1,"canvas-container"],[1,"canvas"],["gridCanvas",""],["board",""],[1,"d-inline-block","align-top","ml-1"],[1,"result"],[4,"ngIf"],[1,"next"],["next",""],[1,"button-container"],[1,"button","play-button",3,"click"],[1,"button","pause-button",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"canvas",3,4)(5,"canvas",3,5),t.qZA()(),t.TgZ(7,"div",6)(8,"div",7)(9,"p")(10,"span"),t._uU(11,"Score"),t.qZA(),t._uU(12),t.qZA(),t.TgZ(13,"p")(14,"span"),t._uU(15,"Level"),t.qZA(),t._uU(16),t.qZA(),t.YNc(17,S,2,0,"p",8),t._UZ(18,"canvas",9,10),t.qZA(),t.TgZ(20,"div",11)(21,"button",12),t.NdJ("click",function(){return i.play()}),t._uU(22,"Play"),t.qZA(),t.TgZ(23,"button",13),t.NdJ("click",function(){return i.pause()}),t._uU(24,"Pause"),t.qZA()()()()),2&e&&(t.xp6(12),t.hij(": ",i.points,""),t.xp6(4),t.hij(": ",i.level,""),t.xp6(1),t.Q6J("ngIf",i.requestId))},dependencies:[C.O5],styles:["[_nghost-%COMP%]{text-align:center}.result[_ngcontent-%COMP%]{text-align:left;margin-left:20px;font-family:var(--font-miso)}.result[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:20px;font-family:Roboto}.result[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:60px;display:inline-block}.button-container[_ngcontent-%COMP%]{margin-left:20px}.button[_ngcontent-%COMP%]{font-size:16px;padding:15px 30px;cursor:pointer;border:1px solid #000;margin-right:10px}.play-button[_ngcontent-%COMP%]{background-color:#ca2c29;color:#fff}.pause-button[_ngcontent-%COMP%]{background-color:#2b84d2;color:#fff}.canvas-container[_ngcontent-%COMP%]{position:relative;width:500px;height:600px}.canvas-container[_ngcontent-%COMP%]   .canvas[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%);border:1px solid #cacaca}"],changeDetection:0}),r})();const Z=[{path:"",component:(()=>{var s;class r{constructor(){}ngOnInit(){}}return(s=r).\u0275fac=function(e){return new(e||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-tetris"]],decls:23,vars:0,consts:[[1,"container"],[1,"content-container"],[1,"page-title"],[1,"content"],[1,"row"],[1,"col-sm-2"],["href","https://medium.com/angular-in-depth/game-development-tetris-in-angular-64ef96ce56f7","target","_blank"],[1,"col-sm-10"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3,"Tetris"),t.qZA(),t.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"h1"),t._uU(8,"Introduction"),t.qZA(),t.TgZ(9,"p"),t._uU(10,"A fun project! You can follow the explanation "),t.TgZ(11,"a",6),t._uU(12,"here"),t.qZA()(),t.TgZ(13,"h1"),t._uU(14,"How to use"),t.qZA(),t.TgZ(15,"p"),t._uU(16,"Up Arrow (\u2191) to rotate the piece"),t.qZA(),t.TgZ(17,"p"),t._uU(18,"Down Arrow (\u2193) to hard drop"),t.qZA(),t.TgZ(19,"p"),t._uU(20,"Left (\u2190) and Right (\u2192) arrow to move the piece"),t.qZA()(),t.TgZ(21,"div",7),t._UZ(22,"tetris-board"),t.qZA()()()()())},dependencies:[R]}),r})(),title:"Syahrul - Tetris"}];let B=(()=>{var s;class r{}return(s=r).\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[T.Bz.forChild(Z),T.Bz]}),r})(),I=(()=>{var s;class r{}return(s=r).\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[C.ez,B]}),r})()}}]);
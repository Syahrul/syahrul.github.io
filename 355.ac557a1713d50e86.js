"use strict";(self.webpackChunksyahrul=self.webpackChunksyahrul||[]).push([[355],{5355:(U,T,v)=>{v.r(T),v.d(T,{TetrisModule:()=>I});var a,_=v(6895),b=v(3994),t=v(4650);const h=30,x=["none","cyan","lightblue","yellow","green","pink","red"],C=[[],[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[2,0,0],[2,2,2],[0,0,0]],[[0,0,3],[3,3,3],[0,0,0]],[[4,4],[4,4]],[[0,5,5],[5,5,0],[0,0,0]],[[0,6,0],[6,6,6],[0,0,0]],[[7,7,0],[0,7,7],[0,0,0]]];let u=(()=>{var s;class n{}return(s=n).ESC="Escape",s.SPACE=" ",s.LEFT="ArrowLeft",s.UP="ArrowUp",s.RIGHT="ArrowRight",s.DOWN="ArrowDown",n})(),m=(()=>{var s;class n{}return(s=n).SINGLE=100,s.DOUBLE=300,s.TRIPLE=500,s.TETRIS=800,s.SOFT_DROP=1,s.HARD_DROP=2,n})();class g{}(a=g)[0]=200,a[1]=190,a[2]=180,a[3]=170,a[4]=160,a[5]=150,a[6]=140,a[7]=130,a[8]=120,a[9]=100,a[10]=80,a[11]=80,a[12]=80,a[13]=70,a[14]=70,a[15]=70,a[16]=50,a[17]=50,a[18]=50,a[19]=30,a[20]=30;class y{constructor(n){this.ctx=n,this.spawn()}spawn(){const n=this.randomizeTetrominoType(x.length-1);this.shape=C[n],this.color=x[n],this.x=4===n?4:3,this.y=0}draw(){const n=1/h;this.shape.forEach((c,e)=>{c.forEach((i,o)=>{i>0&&(this.ctx.fillStyle="black",this.ctx.fillRect(this.x+o-n,this.y+e-n,1+2*n,1+2*n),this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x+o,this.y+e,1,1))})})}drawNext(n){n.clearRect(0,0,n.canvas.width,n.canvas.height);const c=1/h;this.shape.forEach((e,i)=>{e.forEach((o,r)=>{o>0&&(n.fillStyle="black",n.fillRect(r+.05-c,i+.05-c,1+2*c,1+2*c),n.fillStyle=this.color,n.fillRect(r+.05,i+.05,1,1))})})}move(n){this.x=n.x,this.y=n.y,this.shape=n.shape}randomizeTetrominoType(n){return Math.floor(Math.random()*n+1)}}let A=(()=>{var s;class n{valid(e,i){return e.shape.every((o,r)=>o.every((l,d)=>{let w=e.x+d,O=e.y+r;return this.isEmpty(l)||this.insideWalls(w)&&this.aboveFloor(O)&&this.notOccupied(i,w,O)}))}isEmpty(e){return 0===e}insideWalls(e){return e>=0&&e<10}aboveFloor(e){return e<=20}notOccupied(e,i,o){return e[o]&&0===e[o][i]}rotate(e){let i=JSON.parse(JSON.stringify(e));for(let o=0;o<i.shape.length;++o)for(let r=0;r<o;++r)[i.shape[r][o],i.shape[o][r]]=[i.shape[o][r],i.shape[r][o]];return i.shape.forEach(o=>o.reverse()),i}getLinesClearedPoints(e,i){return(i+1)*(1===e?m.SINGLE:2===e?m.DOUBLE:3===e?m.TRIPLE:4===e?m.TETRIS:0)}}return(s=n).\u0275fac=function(e){return new(e||s)},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),n})();const S=["board"],P=["next"];function k(s,n){1&s&&(t.TgZ(0,"p"),t._uU(1,"Next Block"),t.qZA())}let Z=(()=>{var s;class n{keyEvent(e){if("Escape"===e.key)this.gameOver();else if(this.moves[e.key]){e.preventDefault();let i=this.moves[e.key](this.piece);if(" "===e.key)for(;this.service.valid(i,this.board);)this.points+=m.HARD_DROP,this.piece.move(i),i=this.moves[u.DOWN](this.piece);else this.service.valid(i,this.board)&&(this.piece.move(i),"ArrowDown"===e.key&&(this.points+=m.SOFT_DROP))}}constructor(e){this.service=e,this.moves={[u.LEFT]:i=>({...i,x:i.x-1}),[u.RIGHT]:i=>({...i,x:i.x+1}),[u.DOWN]:i=>({...i,y:i.y+1}),[u.SPACE]:i=>({...i,y:i.y+1}),[u.UP]:i=>this.service.rotate(i)}}ngOnInit(){this.initBoard(),this.initNext(),this.resetGame()}initBoard(){this.ctx=this.canvas.nativeElement.getContext("2d"),this.ctx.canvas.width=300,this.ctx.canvas.height=600,this.drawBoardBackground(),this.ctx.scale(h,h)}initNext(){this.ctxNext=this.canvasNext.nativeElement.getContext("2d"),this.ctxNext.canvas.width=150,this.ctxNext.canvas.height=120,this.ctxNext.scale(h,h)}play(){this.resetGame(),this.next=new y(this.ctx),this.piece=new y(this.ctx),this.next.drawNext(this.ctxNext),this.time.start=performance.now(),this.requestId&&cancelAnimationFrame(this.requestId),this.animate()}pause(){!this.requestId||this.isGameOver||(this.isPause=!this.isPause,!this.isPause&&this.requestId?this.animate():(cancelAnimationFrame(this.requestId),this.ctx.fillStyle="black",this.ctx.fillRect(2,2,7,2.5),this.ctx.font="2px miso-bold",this.ctx.fillStyle="red",this.ctx.fillText("PAUSED",2.45,3.9)))}drawBoardBackground(){this.ctx.setTransform(1,0,0,1,0,0);for(let l=0;l<=300;l+=30){let d=0;l>0&&(d=l+.5),300===l&&(d=l),this.ctx.moveTo(d,0),this.ctx.lineTo(d,600)}for(let l=0;l<=600;l+=30){let d=0;l>0&&(d=l+.5),600===l&&(d=l),this.ctx.moveTo(0,d),this.ctx.lineTo(300,d)}this.ctx.strokeStyle="#cacaca",this.ctx.stroke()}resetGame(){this.points=0,this.lines=0,this.level=0,this.board=this.getEmptyBoard(),this.time={start:0,elapsed:0,level:g[this.level]},this.isPause=!1,this.isGameOver=!1}animate(e=0){this.time.elapsed=e-this.time.start,this.time.elapsed>this.time.level&&(this.time.start=e,!this.drop())?this.gameOver():(this.draw(),this.isPause||(this.requestId=requestAnimationFrame(this.animate.bind(this))))}draw(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.drawBoardBackground(),this.ctx.scale(h,h),this.piece.draw(),this.drawBoard()}drop(){let e=this.moves[u.DOWN](this.piece);if(this.service.valid(e,this.board))this.piece.move(e);else{if(this.freeze(),this.clearLines(),0===this.piece.y)return!1;this.piece=this.next,this.next=new y(this.ctx),this.next.drawNext(this.ctxNext)}return!0}clearLines(){let e=0;this.board.forEach((i,o)=>{i.every(r=>0!==r)&&(e++,this.board.splice(o,1),this.board.unshift(Array(10).fill(0)))}),e>0&&(this.points+=this.service.getLinesClearedPoints(e,this.level),this.lines+=e,this.lines>=10&&(this.level++,this.lines-=10,this.time.level=g[this.level]))}freeze(){this.piece.shape.forEach((e,i)=>{e.forEach((o,r)=>{o>0&&(this.board[i+this.piece.y][r+this.piece.x]=o)})})}drawBoard(){const e=1/h;this.board.forEach((i,o)=>{i.forEach((r,l)=>{r>0&&(this.ctx.fillStyle="black",this.ctx.fillRect(l-e,o-e,1+2*e,1+2*e),this.ctx.fillStyle=x[r],this.ctx.fillRect(l,o,1,1))})})}gameOver(){cancelAnimationFrame(this.requestId),this.isGameOver=!0,this.ctx.fillStyle="black",this.ctx.fillRect(1,2,8,2.5),this.ctx.font="2px miso-bold",this.ctx.fillStyle="red",this.ctx.fillText("GAME OVER",1.4,3.9)}getEmptyBoard(){return Array.from({length:20},()=>Array(10).fill(0))}}return(s=n).\u0275fac=function(e){return new(e||s)(t.Y36(A))},s.\u0275cmp=t.Xpm({type:s,selectors:[["tetris-board"]],viewQuery:function(e,i){if(1&e&&(t.Gf(S,7),t.Gf(P,7)),2&e){let o;t.iGM(o=t.CRH())&&(i.canvas=o.first),t.iGM(o=t.CRH())&&(i.canvasNext=o.first)}},hostBindings:function(e,i){1&e&&t.NdJ("keydown",function(r){return i.keyEvent(r)},!1,t.Jf7)},decls:22,vars:3,consts:[[1,"container"],[1,"d-inline-block","align-top"],[1,"game-board"],["board",""],[1,"d-inline-block","align-top","ml-1"],[1,"result"],[4,"ngIf"],[1,"next"],["next",""],[1,"button-container"],[1,"button","play-button",3,"click"],[1,"button","pause-button",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"canvas",2,3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"p")(7,"span"),t._uU(8,"Score"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"p")(11,"span"),t._uU(12,"Level"),t.qZA(),t._uU(13),t.qZA(),t.YNc(14,k,2,0,"p",6),t._UZ(15,"canvas",7,8),t.qZA(),t.TgZ(17,"div",9)(18,"button",10),t.NdJ("click",function(){return i.play()}),t._uU(19,"Play"),t.qZA(),t.TgZ(20,"button",11),t.NdJ("click",function(){return i.pause()}),t._uU(21,"Pause"),t.qZA()()()()),2&e&&(t.xp6(9),t.hij(": ",i.points,""),t.xp6(4),t.hij(": ",i.level,""),t.xp6(1),t.Q6J("ngIf",i.requestId))},dependencies:[_.O5],styles:["[_nghost-%COMP%]{text-align:center}.game-board[_ngcontent-%COMP%]{border:1px solid #000}.result[_ngcontent-%COMP%]{text-align:left;margin-left:20px;font-family:var(--font-miso)}.result[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:20px;font-family:Roboto}.result[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:60px;display:inline-block}.button-container[_ngcontent-%COMP%]{margin-left:20px}.button[_ngcontent-%COMP%]{font-size:16px;padding:15px 30px;cursor:pointer;border:1px solid #000;margin-right:10px}.play-button[_ngcontent-%COMP%]{background-color:#ca2c29;color:#fff}.pause-button[_ngcontent-%COMP%]{background-color:#2b84d2;color:#fff}"]}),n})();const R=[{path:"",component:(()=>{var s;class n{constructor(){}ngOnInit(){}}return(s=n).\u0275fac=function(e){return new(e||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-tetris"]],decls:23,vars:0,consts:[[1,"container"],[1,"content-container"],[1,"page-title"],[1,"content"],[1,"row"],[1,"col-sm-2"],["href","https://medium.com/angular-in-depth/game-development-tetris-in-angular-64ef96ce56f7","target","_blank"],[1,"col-sm-10"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3,"Tetris"),t.qZA(),t.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"h1"),t._uU(8,"Introduction"),t.qZA(),t.TgZ(9,"p"),t._uU(10,"A fun project! You can follow the explanation "),t.TgZ(11,"a",6),t._uU(12,"here"),t.qZA()(),t.TgZ(13,"h1"),t._uU(14,"How to use"),t.qZA(),t.TgZ(15,"p"),t._uU(16,"Up Arrow (\u2191) to rotate the piece"),t.qZA(),t.TgZ(17,"p"),t._uU(18,"Down Arrow (\u2193) to hard drop"),t.qZA(),t.TgZ(19,"p"),t._uU(20,"Left (\u2190) and Right (\u2192) arrow to move the piece"),t.qZA()(),t.TgZ(21,"div",7),t._UZ(22,"tetris-board"),t.qZA()()()()())},dependencies:[Z]}),n})(),title:"Syahrul - Tetris"}];let B=(()=>{var s;class n{}return(s=n).\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[b.Bz.forChild(R),b.Bz]}),n})(),I=(()=>{var s;class n{}return(s=n).\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[_.ez,B]}),n})()}}]);